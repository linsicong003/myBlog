(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{285:function(t,v,a){"use strict";a.r(v);var _=a(0),s=Object(_.a)({},function(){var t=this,v=t.$createElement,a=t._self._c||v;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("p",[t._v("欢迎回来！ 😄")]),t._v(" "),a("p",[t._v("这里是每日练题系列。")]),t._v(" "),a("p",[t._v("这个系列会先分享昨天问题的答案并提出新的问题。")]),t._v(" "),a("h2",{attrs:{id:"回顾上期"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#回顾上期","aria-hidden":"true"}},[t._v("#")]),t._v(" 回顾上期")]),t._v(" "),a("p",[t._v("上期我们提出的问题是：")]),t._v(" "),a("p",[t._v("⭐️ "),a("strong",[t._v("请你谈谈"),a("code",[t._v("前端路由鉴权")])])]),t._v(" "),a("h2",{attrs:{id:"答案公布"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#答案公布","aria-hidden":"true"}},[t._v("#")]),t._v(" 答案公布")]),t._v(" "),a("p",[t._v("细心的读者可以发现，")]),t._v(" "),a("p",[t._v("我们的很多问题已经不存在唯一正确的答案了。")]),t._v(" "),a("p",[t._v("马克思爷爷告诉我们世界上唯一永恒的就是 "),a("code",[t._v("变")]),t._v("，")]),t._v(" "),a("p",[t._v("每一种先进的东西都是历史的，")]),t._v(" "),a("p",[t._v("具体问题具体分析，")]),t._v(" "),a("p",[t._v("不论技术栈发展的如何眼花缭乱，")]),t._v(" "),a("p",[t._v("能做出需求的就是好技术。")]),t._v(" "),a("h3",{attrs:{id:"什么是路由鉴权"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#什么是路由鉴权","aria-hidden":"true"}},[t._v("#")]),t._v(" 什么是路由鉴权 🎏")]),t._v(" "),a("p",[t._v("想要理解什么是 "),a("code",[t._v("路由鉴权")]),t._v("，")]),t._v(" "),a("p",[t._v("我们可以想象那么一个场景：")]),t._v(" "),a("p",[t._v("我们现在拥有一栋写字楼，")]),t._v(" "),a("p",[t._v("需要控制每个业主只能前往固定的活动区域，")]),t._v(" "),a("p",[t._v("划分好了之后实际每个业主的权限既有公共区域（如大堂），也有私有区域（办公室内），")]),t._v(" "),a("p",[t._v("这就是我们做 "),a("code",[t._v("路由鉴权")]),t._v(" 的时候想要完成的工作。")]),t._v(" "),a("h2",{attrs:{id:"路由鉴权的两种方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#路由鉴权的两种方式","aria-hidden":"true"}},[t._v("#")]),t._v(" 路由鉴权的两种方式")]),t._v(" "),a("p",[t._v("路由鉴权于前端而言，")]),t._v(" "),a("p",[t._v("也有两种不同的实现方式。")]),t._v(" "),a("p",[t._v("但万变不离其宗，")]),t._v(" "),a("p",[t._v("我们主要可以将其分为 "),a("code",[t._v("前端鉴权")]),t._v(" 和 "),a("code",[t._v("后端配合鉴权")]),t._v(" 两大类。")]),t._v(" "),a("h3",{attrs:{id:"前端鉴权"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前端鉴权","aria-hidden":"true"}},[t._v("#")]),t._v(" 前端鉴权 🎏")]),t._v(" "),a("p",[t._v("前端鉴权主要走的是减量的思路，参考 "),a("a",{attrs:{href:"https://github.com/PanJiaChen/vue-element-admin/",target:"_blank",rel:"noopener noreferrer"}},[t._v("vue-element-admin"),a("OutboundLink")],1),t._v("。")]),t._v(" "),a("p",[t._v("流程可以是下面的系列步骤：")]),t._v(" "),a("ul",[a("li",[t._v("⭐️ 统一登录页")]),t._v(" "),a("li",[t._v("⭐️ 登录成功存储带有用户信息的 token 值（Cookie、Vuex 或者 localStorage）")]),t._v(" "),a("li",[t._v("⭐️ 路由守卫 "),a("code",[t._v("beforeEach")]),t._v(" 中判断获取权限")])]),t._v(" "),a("div",{staticClass:"tip custom-block"},[a("p",[t._v("如果想避免频繁登录的话可以对 token 进行持久化存储，建议存于 "),a("code",[t._v("sessionStorage")]),t._v("。")])]),t._v(" "),a("p",[t._v("以上仅仅只是一种通用的思路，")]),t._v(" "),a("p",[t._v("落实到具体的实现上又会因人而异。")]),t._v(" "),a("p",[t._v("形如上面的鉴权过程，")]),t._v(" "),a("p",[t._v("🚀")]),t._v(" "),a("p",[t._v("一种是可以让后端在鉴权时返回的是一个标记值，")]),t._v(" "),a("p",[t._v("具体的权限列表存储在前端处，")]),t._v(" "),a("p",[t._v("根据标记值进行路由的筛选。")]),t._v(" "),a("p",[t._v("🚀")]),t._v(" "),a("p",[t._v("另一种是登录后由后端返回一张路由权限表，")]),t._v(" "),a("p",[t._v("前端再根据后端返回的路由权限做减法，")]),t._v(" "),a("p",[t._v("屏蔽掉一部分的路由访问。")]),t._v(" "),a("h3",{attrs:{id:"后端配置鉴权"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#后端配置鉴权","aria-hidden":"true"}},[t._v("#")]),t._v(" 后端配置鉴权 🎏")]),t._v(" "),a("p",[t._v("相对而言，")]),t._v(" "),a("p",[a("code",[t._v("后端配置鉴权")]),t._v(" 更符合当今时代模块化的大潮，")]),t._v(" "),a("p",[t._v("目标是消除前端夜以继日的加班(雾)。")]),t._v(" "),a("p",[t._v("细细研读最近流行的前端框架可以看出来，")]),t._v(" "),a("p",[t._v("都在往一切都可配置的路上靠拢。")]),t._v(" "),a("p",[t._v("从一个方面说，")]),t._v(" "),a("p",[t._v("将路由组件化大大增加了首次开发的工作量，")]),t._v(" "),a("p",[t._v("对于基础较差的童鞋而言这里天坑遍布。")]),t._v(" "),a("p",[t._v("但从另一方面说，")]),t._v(" "),a("p",[t._v("前端将具体业务逻辑脱钩，")]),t._v(" "),a("p",[t._v("更好的保证了项目的灵活性和一致性，")]),t._v(" "),a("p",[t._v("也保障了后续需求的快速迭代。 😄")]),t._v(" "),a("p",[t._v("说了那么多，")]),t._v(" "),a("p",[t._v("我们来看看 "),a("code",[t._v("后端配置鉴权")]),t._v(" 的基本流程：")]),t._v(" "),a("ul",[a("li",[t._v("⭐️ 核心组件还是由前端写死")]),t._v(" "),a("li",[t._v("⭐️ 统一登录后后端返回该用户可用的路由权限页")]),t._v(" "),a("li",[t._v("⭐️ 解析后端返回的路由数据并与当前路由表合并")]),t._v(" "),a("li",[t._v("⭐️ 将原始数据做好存储")])]),t._v(" "),a("p",[t._v("关于这种做法的使用，详细的可以参考这篇大佬的文章 "),a("a",{attrs:{href:"https://juejin.im/post/5caeb3756fb9a068967791b3#heading-0",target:"_blank",rel:"noopener noreferrer"}},[t._v("后台鉴权的另一种思路"),a("OutboundLink")],1)]),t._v(" "),a("h3",{attrs:{id:"细粒度鉴权"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#细粒度鉴权","aria-hidden":"true"}},[t._v("#")]),t._v(" 细粒度鉴权 🎏")]),t._v(" "),a("p",[t._v("搬砖过程中很多时候会遇到一个页面有很多按钮进行 "),a("code",[t._v("细粒度鉴权")]),t._v(" 的情况，")]),t._v(" "),a("div",{staticClass:"tip custom-block"},[a("p",[t._v("这里不单指按钮，某些组件也算在内。")])]),t._v(" "),a("p",[t._v("很明显 "),a("code",[t._v("Vue")]),t._v(" 已经为我们考虑到了这种情况了，使用 "),a("code",[t._v("v-if")]),t._v(" 就能解决我们的问题，")]),t._v(" "),a("p",[t._v("但是这时候又有童鞋可能要问了，")]),t._v(" "),a("p",[t._v("有没有一种简单快捷的方法呢？")]),t._v(" "),a("p",[t._v("这里参考大佬提供的思路 "),a("a",{attrs:{href:"https://juejin.im/post/5cb681a56fb9a0688e0672d5",target:"_blank",rel:"noopener noreferrer"}},[t._v("自定义指令实现鉴权"),a("OutboundLink")],1),t._v("，")]),t._v(" "),a("p",[t._v("我们可以实现这么一个自定义指令：")]),t._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Vue "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'vue'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" store "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'../store'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n * @export 自定义指令\n */")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("directive")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  Vue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("directive")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'permit'")]),t._v("， "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("bind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("el， binding")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 一行三目运算符就可")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("store"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("getters"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("roles"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("includes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("binding"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("parentNode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("removeChild")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br")])]),a("p",[t._v("但是这种做法也有另一个问题，")]),t._v(" "),a("p",[t._v("那就是后端必须为这些鉴权提供权限列表并能实时更新，")]),t._v(" "),a("p",[t._v("这也是很多后端无法做到的，")]),t._v(" "),a("p",[t._v("虽然可以由前端进行数据的再处理，")]),t._v(" "),a("p",[t._v("但这样不仅将问题复杂化了，")]),t._v(" "),a("p",[t._v("也不利于模块化的实现。")]),t._v(" "),a("p",[t._v("🚀")]),t._v(" "),a("p",[t._v("这里有另一种实现的思路是不使用鉴权的方法，")]),t._v(" "),a("p",[t._v("前端方面实现一个中间层算出具体需要渲染的节点数据，")]),t._v(" "),a("p",[t._v("再通过循环进行渲染，")]),t._v(" "),a("p",[t._v("这样就可以实现轻便简易的配置化修改了。")]),t._v(" "),a("p",[t._v("理想很丰满，现实很骨感。")]),t._v(" "),a("p",[t._v("这种实现虽好但是只适用于需求样式差不多的情况。")]),t._v(" "),a("p",[t._v("😏")]),t._v(" "),a("p",[t._v("这里埋个坑，")]),t._v(" "),a("p",[t._v("往后遇到更好的方法会在这边继续更新。")]),t._v(" "),a("h3",{attrs:{id:"参考资料"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考资料","aria-hidden":"true"}},[t._v("#")]),t._v(" 参考资料 🎏")]),t._v(" "),a("ul",[a("li",[t._v("https://zhongwq.github.io/SystemAnalysis/Vue%E5%89%8D%E7%AB%AF%E8%B7%AF%E7%94%B1%E9%89%B4%E6%9D%83%E7%9A%84%E4%BD%BF%E7%94%A8/")]),t._v(" "),a("li",[t._v("https://juejin.im/post/591aa14f570c35006961acac")]),t._v(" "),a("li",[t._v("https://juejin.im/post/5caeb3756fb9a068967791b3#heading-0")]),t._v(" "),a("li",[t._v("https://segmentfault.com/a/1190000018215599")]),t._v(" "),a("li",[t._v("https://juejin.im/post/5cb681a56fb9a0688e0672d5")])]),t._v(" "),a("h2",{attrs:{id:"提问"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#提问","aria-hidden":"true"}},[t._v("#")]),t._v(" 提问")]),t._v(" "),a("p",[t._v("讲解完了昨天的问题，又到了今天的提问环节啦~")]),t._v(" "),a("h3",{attrs:{id:"背景"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#背景","aria-hidden":"true"}},[t._v("#")]),t._v(" 背景 🎏")]),t._v(" "),a("p",[t._v("前端在很多时候，")]),t._v(" "),a("p",[t._v("也需要缓存一些应用中的数据，")]),t._v(" "),a("p",[t._v("从 IE 时代开始，")]),t._v(" "),a("p",[t._v("就提供了 "),a("code",[t._v("Cookie")]),t._v(" 这种存储方式，")]),t._v(" "),a("p",[t._v("后面随着 WEB 应用的日益增大，")]),t._v(" "),a("p",[t._v("大家渐渐发现 "),a("code",[t._v("Cookie")]),t._v(" 的存储大小限制大大阻碍了前端应用的发展，")]),t._v(" "),a("p",[t._v("后就有了各种新的方法。")]),t._v(" "),a("h3",{attrs:{id:"今日提问"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#今日提问","aria-hidden":"true"}},[t._v("#")]),t._v(" 今日提问 🎏")]),t._v(" "),a("p",[t._v("总的说来，")]),t._v(" "),a("p",[t._v("到本篇文章书写为止一共有那么几种方式可以做前端存储，")]),t._v(" "),a("p",[t._v("他们分别是 "),a("code",[t._v("Cookie")]),t._v("、"),a("code",[t._v("localStorage")]),t._v("、"),a("code",[t._v("sessionStorage")]),t._v("、"),a("code",[t._v("indexDB")]),t._v("。")]),t._v(" "),a("hr"),t._v(" "),a("p",[a("strong",[t._v("今天的问题是：")])]),t._v(" "),a("p",[t._v("⭐️ "),a("strong",[t._v("试分析各种前端存储的区别与优劣势")])])])},[],!1,null,null,null);v.default=s.exports}}]);