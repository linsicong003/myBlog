<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>æ¯æ—¥ç»ƒé¢˜#7 | Clancyå°å±‹</title>
    <meta name="description" content="æ…¢æ…¢æ¥   æ¯”è¾ƒå¿«">
    <link rel="icon" href="icon.ico">
  <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    <meta property="article:published_time" content="2019-10-28T00:00:00.000Z"><meta property="article:modified_time" content="2019-10-30T08:08:34.000Z"><meta property="og:site_name" content="Clancyå°å±‹"><meta property="og:title" content="æ¯æ—¥ç»ƒé¢˜#7"><meta property="og:type" content="website"><meta property="og:url" content="/DailyTest/2019-10-28-7.html"><meta name="twitter:title" content="æ¯æ—¥ç»ƒé¢˜#7"><meta name="twitter:url" content="/DailyTest/2019-10-28-7.html"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:label1" content="Written by"><meta name="twitter:label2" content="Filed under"><meta name="twitter:data2" content="DailyTest"><meta property="article:tag" content="DailyTest">
    <link rel="preload" href="/assets/css/0.styles.19997978.css" as="style"><link rel="preload" href="/assets/js/app.2e933218.js" as="script"><link rel="preload" href="/assets/js/3.b415292c.js" as="script"><link rel="preload" href="/assets/js/2.5bb3cc47.js" as="script"><link rel="preload" href="/assets/js/1.e6878f8a.js" as="script"><link rel="preload" href="/assets/js/15.0c829d9c.js" as="script"><link rel="prefetch" href="/assets/js/10.2218a443.js"><link rel="prefetch" href="/assets/js/11.ad5e0bb1.js"><link rel="prefetch" href="/assets/js/12.319aab6c.js"><link rel="prefetch" href="/assets/js/13.f3f15c9f.js"><link rel="prefetch" href="/assets/js/14.a5314aae.js"><link rel="prefetch" href="/assets/js/16.b528e04f.js"><link rel="prefetch" href="/assets/js/17.6adca3ae.js"><link rel="prefetch" href="/assets/js/18.8973fcc9.js"><link rel="prefetch" href="/assets/js/19.4cf114fa.js"><link rel="prefetch" href="/assets/js/20.2a234325.js"><link rel="prefetch" href="/assets/js/21.7454c98e.js"><link rel="prefetch" href="/assets/js/22.f1d36600.js"><link rel="prefetch" href="/assets/js/23.f5cc851a.js"><link rel="prefetch" href="/assets/js/24.e5987bfa.js"><link rel="prefetch" href="/assets/js/25.80bbd491.js"><link rel="prefetch" href="/assets/js/26.85df4427.js"><link rel="prefetch" href="/assets/js/27.fcaa99e3.js"><link rel="prefetch" href="/assets/js/28.30a38c64.js"><link rel="prefetch" href="/assets/js/29.4a01143a.js"><link rel="prefetch" href="/assets/js/30.2d773599.js"><link rel="prefetch" href="/assets/js/31.188ac7d3.js"><link rel="prefetch" href="/assets/js/32.5ac67534.js"><link rel="prefetch" href="/assets/js/33.2c9ec258.js"><link rel="prefetch" href="/assets/js/34.6b9d7be4.js"><link rel="prefetch" href="/assets/js/35.f5eb46ef.js"><link rel="prefetch" href="/assets/js/36.de791992.js"><link rel="prefetch" href="/assets/js/37.f431e2ed.js"><link rel="prefetch" href="/assets/js/38.9e22c914.js"><link rel="prefetch" href="/assets/js/39.72b78c28.js"><link rel="prefetch" href="/assets/js/40.db20de6e.js"><link rel="prefetch" href="/assets/js/41.84acc8b2.js"><link rel="prefetch" href="/assets/js/42.a7608755.js"><link rel="prefetch" href="/assets/js/43.d49b3f27.js"><link rel="prefetch" href="/assets/js/44.a1a05185.js"><link rel="prefetch" href="/assets/js/45.952eaa28.js"><link rel="prefetch" href="/assets/js/46.fef9e55c.js"><link rel="prefetch" href="/assets/js/47.6bc0e4c5.js"><link rel="prefetch" href="/assets/js/48.d7124bde.js"><link rel="prefetch" href="/assets/js/49.3e298871.js"><link rel="prefetch" href="/assets/js/5.f6389712.js"><link rel="prefetch" href="/assets/js/50.57a15a56.js"><link rel="prefetch" href="/assets/js/51.80607a81.js"><link rel="prefetch" href="/assets/js/52.e14fae39.js"><link rel="prefetch" href="/assets/js/53.2b6ca8ae.js"><link rel="prefetch" href="/assets/js/54.cf269526.js"><link rel="prefetch" href="/assets/js/55.3a58f492.js"><link rel="prefetch" href="/assets/js/56.c7e3df0c.js"><link rel="prefetch" href="/assets/js/57.3f085484.js"><link rel="prefetch" href="/assets/js/58.11eef191.js"><link rel="prefetch" href="/assets/js/59.4ba31f5e.js"><link rel="prefetch" href="/assets/js/6.6855f3d5.js"><link rel="prefetch" href="/assets/js/60.03269639.js"><link rel="prefetch" href="/assets/js/61.17f354e4.js"><link rel="prefetch" href="/assets/js/62.114b6997.js"><link rel="prefetch" href="/assets/js/63.53911c87.js"><link rel="prefetch" href="/assets/js/64.0bdab71f.js"><link rel="prefetch" href="/assets/js/65.be877a7f.js"><link rel="prefetch" href="/assets/js/66.6aa3794b.js"><link rel="prefetch" href="/assets/js/67.c462bd8a.js"><link rel="prefetch" href="/assets/js/68.86dd1cf8.js"><link rel="prefetch" href="/assets/js/69.2b1e23ae.js"><link rel="prefetch" href="/assets/js/7.8b56e7b5.js"><link rel="prefetch" href="/assets/js/70.cf6d8573.js"><link rel="prefetch" href="/assets/js/71.8532ebff.js"><link rel="prefetch" href="/assets/js/72.dfd1a0fd.js"><link rel="prefetch" href="/assets/js/73.5b8c26cb.js"><link rel="prefetch" href="/assets/js/74.9ef6950d.js"><link rel="prefetch" href="/assets/js/75.248f283b.js"><link rel="prefetch" href="/assets/js/76.645f2a5b.js"><link rel="prefetch" href="/assets/js/77.98dc7580.js"><link rel="prefetch" href="/assets/js/78.b2946743.js"><link rel="prefetch" href="/assets/js/79.1fa17d17.js"><link rel="prefetch" href="/assets/js/8.98060d06.js"><link rel="prefetch" href="/assets/js/80.86b24084.js"><link rel="prefetch" href="/assets/js/9.142606f3.js">
    <link rel="stylesheet" href="/assets/css/0.styles.19997978.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div><div class="bg-container"><div id="particles-oli-wrapper" data-v-c339c0f6></div></div> <div class="main-container common"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="https://blog-img-1252360401.cos.ap-guangzhou.myqcloud.com/logo.jpg" alt="Clancyå°å±‹" class="logo"> <span class="site-name">Clancyå°å±‹</span></a> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-gitlab"></i>
  é¦–é¡µ
</a></div><div class="nav-item"><a href="/category/ET/" class="nav-link"><i class="iconfont reco-eye"></i>
  æ•™è‚²æŠ€æœ¯
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-api"></i>
      å‰ç«¯
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/category/Front/" class="nav-link"><i class="iconfont undefined"></i>
  å‰ç«¯åŸºç¡€
</a></li><li class="dropdown-item"><!----> <a href="/category/TS/" class="nav-link"><i class="iconfont undefined"></i>
  TypeScript
</a></li><li class="dropdown-item"><!----> <a href="/category/Comment/" class="nav-link"><i class="iconfont undefined"></i>
  æ‚è°ˆ
</a></li><li class="dropdown-item"><!----> <a href="/DailyTest/Navigator.html" class="nav-link"><i class="iconfont undefined"></i>
  ç»ƒé¢˜ç¬”è®°
</a></li></ul></div></div><div class="nav-item"><a href="/timeLine.html" class="nav-link"><i class="iconfont reco-three"></i>
  æ—¶å…‰æœº
</a></div><div class="nav-item"><a href="/AboutMe.html" class="nav-link"><i class="iconfont reco-other"></i>
  å…³äºæˆ‘
</a></div> <!----></nav> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div></div></header> <div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;background-color:rgba(231, 234, 241,.5);display:none;" data-v-6656a0de data-v-6656a0de><i class="iconfont reco-up" data-v-6656a0de></i></div> <div id="common" class="theme-container"><!----> <div id="mainContent" class="common-content"><div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-gitlab"></i>
  é¦–é¡µ
</a></div><div class="nav-item"><a href="/category/ET/" class="nav-link"><i class="iconfont reco-eye"></i>
  æ•™è‚²æŠ€æœ¯
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-api"></i>
      å‰ç«¯
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/category/Front/" class="nav-link"><i class="iconfont undefined"></i>
  å‰ç«¯åŸºç¡€
</a></li><li class="dropdown-item"><!----> <a href="/category/TS/" class="nav-link"><i class="iconfont undefined"></i>
  TypeScript
</a></li><li class="dropdown-item"><!----> <a href="/category/Comment/" class="nav-link"><i class="iconfont undefined"></i>
  æ‚è°ˆ
</a></li><li class="dropdown-item"><!----> <a href="/DailyTest/Navigator.html" class="nav-link"><i class="iconfont undefined"></i>
  ç»ƒé¢˜ç¬”è®°
</a></li></ul></div></div><div class="nav-item"><a href="/timeLine.html" class="nav-link"><i class="iconfont reco-three"></i>
  æ—¶å…‰æœº
</a></div><div class="nav-item"><a href="/AboutMe.html" class="nav-link"><i class="iconfont reco-other"></i>
  å…³äºæˆ‘
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>æ¯æ—¥ç»ƒé¢˜#7</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/DailyTest/2019-10-28-7.html#å›é¡¾ä¸ŠæœŸ" class="sidebar-link">å›é¡¾ä¸ŠæœŸ</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/DailyTest/2019-10-28-7.html#ç­”æ¡ˆå…¬å¸ƒ" class="sidebar-link">ç­”æ¡ˆå…¬å¸ƒ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/DailyTest/2019-10-28-7.html#ç®€æ˜“å®ç°" class="sidebar-link">ç®€æ˜“å®ç° ğŸ</a></li><li class="sidebar-sub-header"><a href="/DailyTest/2019-10-28-7.html#å®Œæ•´å®ç°" class="sidebar-link">å®Œæ•´å®ç°</a></li><li class="sidebar-sub-header"><a href="/DailyTest/2019-10-28-7.html#å‚è€ƒèµ„æ–™" class="sidebar-link">å‚è€ƒèµ„æ–™ ğŸ</a></li></ul></li><li><a href="/DailyTest/2019-10-28-7.html#æé—®" class="sidebar-link">æé—®</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/DailyTest/2019-10-28-7.html#èƒŒæ™¯" class="sidebar-link">èƒŒæ™¯ ğŸ</a></li><li class="sidebar-sub-header"><a href="/DailyTest/2019-10-28-7.html#ä»Šæ—¥æé—®" class="sidebar-link">ä»Šæ—¥æé—® ğŸ</a></li></ul></li></ul></section></li></ul> </aside> <div><div><main class="page reco-hide"> <div class="page-title"><h1>æ¯æ—¥ç»ƒé¢˜#7</h1> <hr> <div style="position:relative;" data-v-6e6f5ac2><i class="iconfont reco-account" data-v-6e6f5ac2><span data-v-6e6f5ac2>Clancy Lin</span></i> <i class="iconfont reco-date" data-v-6e6f5ac2><span data-v-6e6f5ac2>2019-10-28</span></i> <!----> <i class="iconfont reco-tag tags" data-v-6e6f5ac2><span class="tag-item" data-v-6e6f5ac2>DailyTest</span></i> <span class="pageFull" data-v-6e6f5ac2>å…¨å±</span></div></div> <div class="content__default"><p>æ¬¢è¿å›æ¥ï¼ ğŸ˜„</p> <p>è¿™é‡Œæ˜¯æ¯æ—¥ç»ƒé¢˜ç³»åˆ—ã€‚</p> <p>è¿™ä¸ªç³»åˆ—ä¼šå…ˆåˆ†äº«æ˜¨å¤©é—®é¢˜çš„ç­”æ¡ˆå¹¶æå‡ºæ–°çš„é—®é¢˜ã€‚</p> <h2 id="å›é¡¾ä¸ŠæœŸ"><a href="#å›é¡¾ä¸ŠæœŸ" aria-hidden="true" class="header-anchor">#</a> å›é¡¾ä¸ŠæœŸ</h2> <p>ä¸ŠæœŸæˆ‘ä»¬æå‡ºçš„é—®é¢˜æ˜¯ï¼š</p> <p>â­ï¸ <strong>è¯·ä½ å®ç°ä¸€ä¸ª <code>èŠ‚æµå‡½æ•°</code> å’Œ <code>é˜²æŠ–å‡½æ•°</code></strong></p> <h2 id="ç­”æ¡ˆå…¬å¸ƒ"><a href="#ç­”æ¡ˆå…¬å¸ƒ" aria-hidden="true" class="header-anchor">#</a> ç­”æ¡ˆå…¬å¸ƒ</h2> <p><code>èŠ‚æµå‡½æ•°(throttle)</code> å®è´¨å¯ä»¥çœ‹åš <code>é˜²æŠ–å‡½æ•°(debounce)</code> çš„ä¸€ä¸ªè®¾ç½®æœ€å¤§è¿è¡Œæ—¶é—´çš„ç‰ˆæœ¬ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘åœ¨è¿™é‡ŒæŠŠå®ƒä»¬ä¸¤ä¸ªæ”¾åœ¨ä¸€èµ·çš„åŸå› ã€‚</p> <p>åœ¨è¿™é‡Œå¼•ç”¨ <code>lodash</code> å¯¹ <code>é˜²æŠ–å‡½æ•°</code> çš„ä»‹ç»ï¼š</p> <blockquote><p>Creates a debounced function that delays invoking func until after wait milliseconds have elapsed since the last time the debounced function was invoked. The debounced function comes with a cancel method to cancel delayed func invocations and a flush method to immediately invoke them. Provide options to indicate whether func should be invoked on the leading and/or trailing edge of the wait timeout. The func is invoked with the last arguments provided to the debounced function. Subsequent calls to the debounced function return the result of the last func invocation.</p></blockquote> <p>ç®€å•ç¿»è¯‘ä¸€ä¸‹å°±æ˜¯ä¸‹é¢è¿™ä¹ˆä¸ªæ„æ€ï¼š</p> <ul><li>â­ï¸ <strong>åˆ›å»ºä¸€ä¸ª <code>é˜²æŠ–å‡½æ•°ï¼ˆdebounced functionï¼‰</code> å°†å»¶è¿Ÿè°ƒç”¨ä¼ å…¥çš„å¤„ç†æ–¹æ³•ç›´è‡³æœ€åä¸€ä¸ª <code>wait</code> è®¡æ—¶å™¨è®¡æ—¶ç»“æŸã€‚</strong></li> <li>â­ï¸ ä¸æ­¤åŒæ—¶ <code>é˜²æŠ–å‡½æ•°</code> è¿˜æä¾›ä¸€ä¸ª <code>cancel</code> æ–¹æ³•æ¥åˆ é™¤è¢«å»¶è¿Ÿçš„å‡½æ•°ä»¥åŠä¸€ä¸ª <code>flush</code> æ–¹æ³•æ¥é©¬ä¸Šè°ƒç”¨ä»–ä»¬ï¼Œä½ è¿˜å¯ä»¥é€šè¿‡é€‰é¡¹çš„æ–¹å¼æ¥é€‰æ‹©åœ¨è¶…æ—¶çš„å‰æ–¹æˆ–åæ–¹è¿›è¡Œè°ƒç”¨ã€‚</li> <li>â­ï¸ å‡½æ•°è°ƒç”¨æ—¶å°†ä¼šä½¿ç”¨ <code>æœ€åä¸€æ¬¡</code> ä¼ å…¥çš„å‚æ•°å¹¶å°†ä½œä¸º <code>é˜²æŠ–å‡½æ•°</code> çš„è¿”å›ç»“æœã€‚</li></ul> <p>ğŸ™€ ä¸‹é¢æˆ‘ä»¬å°±ä¸€èµ·æ¥çœ‹çœ‹å…·ä½“çš„å®ç°ï¼š</p> <h3 id="ç®€æ˜“å®ç°"><a href="#ç®€æ˜“å®ç°" aria-hidden="true" class="header-anchor">#</a> ç®€æ˜“å®ç° ğŸ</h3> <p>é—®äº†åº¦å¨˜çŸ¥é“ï¼Œç½‘ä¸Šçš„åšå®¢å¤§å¤šæµä¼ çš„æ˜¯ç®€æ˜“ç‰ˆæœ¬çš„é˜²æŠ–å‡½æ•°ï¼Œå…·ä½“å®ç°å¦‚ä¸‹ï¼š</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// é˜²æŠ–å‡½æ•°</span>
<span class="token keyword">const</span> <span class="token function-variable function">debounce</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">func<span class="token punctuation">,</span> wait</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> timer<span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
    timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>func<span class="token punctuation">,</span> wait<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>ä»£ç æ¯”è¾ƒç®€å•ï¼Œè¿™é‡Œå°±ä¸åšè¿‡å¤šè§£é‡Šäº†ã€‚ ğŸ˜„</p> <p>æ‰¿æ¥è¿™ç§æ€è·¯çš„ <code>èŠ‚æµå‡½æ•°</code> çš„å®ç°æ–¹æ³•æˆ‘ä»¬è‡ªç„¶è€Œç„¶èƒ½æƒ³åˆ°æ˜¯è¿™æ ·çš„ï¼š</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// èŠ‚æµå‡½æ•°</span>
<span class="token keyword">const</span> <span class="token function-variable function">throttle</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">func<span class="token punctuation">,</span> wait</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> timer<span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>timer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> wait<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>åˆ°è¿™å¯èƒ½ä¼šæœ‰çš„å°ä¼™ä¼´è¯´è¿™ä¸ªå®ç°ä¹Ÿå¤ªç®€å•äº†å§ï¼Œè¿˜æœ‰å¾ˆå¤šéƒ½æ²¡è€ƒè™‘åˆ° ğŸ</p> <p>é‚£ä¹ˆä¸‹é¢ç»™å‡ºä¸€ç§å¤šåŠ ä¸€äº›è¾¹ç•Œæƒ…å†µè€ƒè™‘çš„å®ç°ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ç¬”è€…è‡ªå·±ç”¨çš„æ¯”è¾ƒå¤šçš„ä¸€ç§å®ç°ï¼š</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// èŠ‚æµå‡½æ•°</span>
<span class="token comment">/**
 * @method
 * @param {function} fn - å¤„ç†å‡½æ•°
 * @param {number} delay - å»¶è¿Ÿæ—¶é—´
 * @param {number} duration - æœ€å¤§å»¶è¿Ÿæ—¶é—´
 * @returns {function} - è¢«å»¶è¿Ÿçš„å¤„ç†å‡½æ•°
 * @description: å‡½æ•°èŠ‚æµ
 * @author: Clancy Lin
 * @date: 2019-10-28
 */</span>
<span class="token keyword">const</span> <span class="token function-variable function">throttle</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> delay<span class="token punctuation">,</span> duration</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>fn <span class="token operator">||</span> <span class="token keyword">typeof</span> fn <span class="token operator">!==</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token function">Error</span><span class="token punctuation">(</span><span class="token string">'Please offer a function to solve something'</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>delay<span class="token punctuation">)</span> delay <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>duration<span class="token punctuation">)</span> duration <span class="token operator">=</span> <span class="token number">0</span>
<span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span>
<span class="token keyword">let</span> begin <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> context <span class="token operator">=</span> <span class="token keyword">this</span>
    <span class="token keyword">let</span> args <span class="token operator">=</span> arguments
    <span class="token keyword">let</span> current <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>current <span class="token operator">-</span> begin <span class="token operator">&gt;=</span> duration<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> args<span class="token punctuation">)</span>
    begin <span class="token operator">=</span> current
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> args<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> delay<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><div class="tip custom-block"><p>è¿™ç§å®ç°ä¾ç„¶å­˜åœ¨é—®é¢˜ï¼Œè¡¨ç°åœ¨å‡½æ•°æ‰§è¡Œæ—¶é—´ä¸ç¨³å®šçš„é—®é¢˜ã€‚</p></div> <p>â­ï¸ å¦‚æœåªæ˜¯è¿½æ±‚ç®€å•å®ç”¨çš„ç«¥é‹çœ‹åˆ°è¿™é‡Œå°±å¤Ÿäº†ï¼Œ<code>èŠ‚æµå‡½æ•°</code> å·²ç»åŸºæœ¬å®ç°ã€‚</p> <p>å¯ä»¥ç›´æ¥æ»‘åˆ°ä¸‹æ–¹çœ‹æˆ‘ä»¬ä»Šå¤©çš„é—®é¢˜äº†ã€‚</p> <p>æœ‰è¿½æ±‚çš„å°ä¼™ä¼´è·Ÿç€æˆ‘ç»§ç»­å¾€ä¸‹é¢èµ°ï¼Œä¸‹é¢å°†ä»¥ <code>lodash</code> çš„å®ç°æ¥è¿›ä¸€æ­¥åŠ æ·±å¯¹è¿™ç§ <code>å»¶è¿Ÿä¼˜åŒ–</code> æœºåˆ¶çš„ç†è§£ã€‚</p> <h3 id="å®Œæ•´å®ç°"><a href="#å®Œæ•´å®ç°" aria-hidden="true" class="header-anchor">#</a> å®Œæ•´å®ç°</h3> <p>æœ€ååº”å®ç°è¿™ä¹ˆä¸€ä¸ªæ‰§è¡Œæµç¨‹ï¼š</p> <p><img src="https://blog-img-1252360401.cos.ap-guangzhou.myqcloud.com/2019-10-28-1.png" alt="èŠ‚æµæ‰§è¡Œ"></p> <p>ä¸‹é¢ç›´æ¥ä¸Š loadsh çš„æºç ï¼Œç›¸å…³è®²è§£å°†æ”¾ç½®äºæ³¨é‡Šä¹‹ä¸­ï¼š</p> <p>å…³äºä½¿ç”¨æ–¹æ³•è¯·ç›´æ¥å‚è€ƒ <code>loadsh</code> çš„æ–‡æ¡£ï¼ˆç§‘å­¦ä¸Šç½‘ï¼‰ï¼š <a href="https://www.lodashjs.com/docs/4.17.5.html#debounce" target="_blank" rel="noopener noreferrer">ä¼ é€é—¨<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// é˜²æŠ–å‡½æ•°</span>
<span class="token keyword">function</span> <span class="token function">debounce</span><span class="token punctuation">(</span><span class="token parameter">func<span class="token punctuation">,</span> wait<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> lastArgs<span class="token punctuation">,</span>
        lastThis<span class="token punctuation">,</span>
        maxWait<span class="token punctuation">,</span>
        result<span class="token punctuation">,</span>
        timerId<span class="token punctuation">,</span>
        lastCallTime

    <span class="token comment">// å‚æ•°åˆå§‹åŒ–</span>
    <span class="token keyword">let</span> lastInvokeTime <span class="token operator">=</span> <span class="token number">0</span> <span class="token comment">// func ä¸Šä¸€æ¬¡æ‰§è¡Œçš„æ—¶é—´</span>
    <span class="token keyword">let</span> leading <span class="token operator">=</span> <span class="token boolean">false</span>
    <span class="token keyword">let</span> maxing <span class="token operator">=</span> <span class="token boolean">false</span>
    <span class="token keyword">let</span> trailing <span class="token operator">=</span> <span class="token boolean">true</span>

    <span class="token comment">// åŸºæœ¬çš„ç±»å‹åˆ¤æ–­å’Œå¤„ç†</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> func <span class="token operator">!=</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TypeError</span><span class="token punctuation">(</span><span class="token string">'Expected a function'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    wait <span class="token operator">=</span> <span class="token operator">+</span>wait <span class="token operator">||</span> <span class="token number">0</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isObject</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// å¯¹é…ç½®çš„ä¸€äº›åˆå§‹åŒ–</span>
        leading <span class="token operator">=</span> <span class="token operator">!</span><span class="token operator">!</span>options<span class="token punctuation">.</span>leading
        maxing <span class="token operator">=</span> <span class="token string">'maxWait'</span> <span class="token keyword">in</span> options
        maxWait <span class="token operator">=</span> maxing <span class="token operator">?</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token operator">+</span>options<span class="token punctuation">.</span>maxWait <span class="token operator">||</span> <span class="token number">0</span><span class="token punctuation">,</span> wait<span class="token punctuation">)</span> <span class="token punctuation">:</span> maxWait
        trailing <span class="token operator">=</span> <span class="token string">'trailing'</span> <span class="token keyword">in</span> options <span class="token operator">?</span> <span class="token operator">!</span><span class="token operator">!</span>options<span class="token punctuation">.</span>trailing <span class="token punctuation">:</span> trailing
    <span class="token punctuation">}</span>

    <span class="token comment">// è°ƒç”¨å‡½æ•°</span>
    <span class="token keyword">function</span> <span class="token function">invokeFunc</span><span class="token punctuation">(</span><span class="token parameter">time</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> args <span class="token operator">=</span> lastArgs
        <span class="token keyword">const</span> thisArg <span class="token operator">=</span> lastThis

        lastArgs <span class="token operator">=</span> lastThis <span class="token operator">=</span> <span class="token keyword">undefined</span>
        lastInvokeTime <span class="token operator">=</span> time
        result <span class="token operator">=</span> <span class="token function">func</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>thisArg<span class="token punctuation">,</span> args<span class="token punctuation">)</span>
        <span class="token keyword">return</span> result
    <span class="token punctuation">}</span>

    <span class="token comment">// æ—  timerId æ‰§è¡Œï¼Œé¦–æ¬¡æˆ–è€…å·²ç»è°ƒç”¨è¿‡</span>
    <span class="token keyword">function</span> <span class="token function">leadingEdge</span><span class="token punctuation">(</span><span class="token parameter">time</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Reset any `maxWait` timer.</span>
        lastInvokeTime <span class="token operator">=</span> time
        <span class="token comment">// ä¸º trailing edge è§¦å‘å‡½æ•°è°ƒç”¨è®¾å®šå®šæ—¶å™¨</span>
        timerId <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>timerExpired<span class="token punctuation">,</span> wait<span class="token punctuation">)</span>
        <span class="token comment">// leading = true æ‰§è¡Œå‡½æ•°</span>
        <span class="token keyword">return</span> leading <span class="token operator">?</span> <span class="token function">invokeFunc</span><span class="token punctuation">(</span>time<span class="token punctuation">)</span> <span class="token punctuation">:</span> result
    <span class="token punctuation">}</span>

    <span class="token comment">// è®¡ç®—ä¸‹æ¬¡çš„è®¡æ—¶å™¨æ—¶é—´</span>
   <span class="token keyword">function</span> <span class="token function">remainingWait</span><span class="token punctuation">(</span><span class="token parameter">time</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> timeSinceLastCall <span class="token operator">=</span> time <span class="token operator">-</span> lastCallTime <span class="token comment">// è·ç¦»ä¸Šæ¬¡debouncedå‡½æ•°è¢«è°ƒç”¨çš„æ—¶é—´</span>
        <span class="token keyword">const</span> timeSinceLastInvoke <span class="token operator">=</span> time <span class="token operator">-</span> lastInvokeTime <span class="token comment">// è·ç¦»ä¸Šæ¬¡å‡½æ•°è¢«æ‰§è¡Œçš„æ—¶é—´</span>
        <span class="token keyword">const</span> timeWaiting <span class="token operator">=</span> wait <span class="token operator">-</span> timeSinceLastCall <span class="token comment">// ç”¨ wait å‡å» timeSinceLastCall è®¡ç®—å‡ºä¸‹ä¸€æ¬¡trailingçš„ä½ç½®</span>

        <span class="token comment">// ä¸¤ç§æƒ…å†µ</span>
        <span class="token comment">// æœ‰maxing:æ¯”è¾ƒå‡ºä¸‹ä¸€æ¬¡maxingå’Œä¸‹ä¸€æ¬¡trailingçš„æœ€å°å€¼ï¼Œä½œä¸ºä¸‹ä¸€æ¬¡å‡½æ•°è¦æ‰§è¡Œçš„æ—¶é—´</span>
        <span class="token comment">// æ— maxingï¼šåœ¨ä¸‹ä¸€æ¬¡trailingæ—¶æ‰§è¡Œ timerExpired</span>
        <span class="token keyword">return</span> maxing
            <span class="token operator">?</span> Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>timeWaiting<span class="token punctuation">,</span> maxWait <span class="token operator">-</span> timeSinceLastInvoke<span class="token punctuation">)</span>
            <span class="token punctuation">:</span> timeWaiting
    <span class="token punctuation">}</span>

    <span class="token comment">// æ ¹æ®æ—¶é—´åˆ¤æ–­ func èƒ½å¦è¢«æ‰§è¡Œ</span>
    <span class="token keyword">function</span> <span class="token function">shouldInvoke</span><span class="token punctuation">(</span><span class="token parameter">time</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> timeSinceLastCall <span class="token operator">=</span> time <span class="token operator">-</span> lastCallTime
        <span class="token keyword">const</span> timeSinceLastInvoke <span class="token operator">=</span> time <span class="token operator">-</span> lastInvokeTime

        <span class="token comment">// å‡ ç§æ»¡è¶³æ¡ä»¶çš„æƒ…å†µ</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>lastCallTime <span class="token operator">===</span> <span class="token keyword">undefined</span> <span class="token comment">//é¦–æ¬¡</span>
            <span class="token operator">||</span> <span class="token punctuation">(</span>timeSinceLastCall <span class="token operator">&gt;=</span> wait<span class="token punctuation">)</span> <span class="token comment">// è·ç¦»ä¸Šæ¬¡è¢«è°ƒç”¨å·²ç»è¶…è¿‡ wait</span>
            <span class="token operator">||</span> <span class="token punctuation">(</span>timeSinceLastCall <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">//ç³»ç»Ÿæ—¶é—´å€’é€€</span>
            <span class="token operator">||</span> <span class="token punctuation">(</span>maxing <span class="token operator">&amp;&amp;</span> timeSinceLastInvoke <span class="token operator">&gt;=</span> maxWait<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//è¶…è¿‡æœ€å¤§ç­‰å¾…æ—¶é—´</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// ç”Ÿæˆè®¡æ—¶å™¨</span>
    <span class="token comment">// ä½œç”¨æ˜¯è§¦å‘ trailling</span>
    <span class="token keyword">function</span> <span class="token function">timerExpired</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> time <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment">// åœ¨ trailing edge ä¸”æ—¶é—´ç¬¦åˆæ¡ä»¶æ—¶ï¼Œè°ƒç”¨ trailingEdgeå‡½æ•°ï¼Œå¦åˆ™é‡å¯å®šæ—¶å™¨</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">shouldInvoke</span><span class="token punctuation">(</span>time<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token function">trailingEdge</span><span class="token punctuation">(</span>time<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// é‡å¯å®šæ—¶å™¨ï¼Œä¿è¯ä¸‹ä¸€æ¬¡æ—¶å»¶çš„æœ«å°¾è§¦å‘</span>
        timerId <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>timerExpired<span class="token punctuation">,</span> <span class="token function">remainingWait</span><span class="token punctuation">(</span>time<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// æœ€åä¸€æ¬¡å‡½æ•°æ‰§è¡Œ</span>
    <span class="token keyword">function</span> <span class="token function">trailingEdge</span><span class="token punctuation">(</span><span class="token parameter">time</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        timerId <span class="token operator">=</span> <span class="token keyword">undefined</span>

        <span class="token comment">// æœ‰lastArgsæ‰æ‰§è¡Œï¼Œæ„å‘³ç€åªæœ‰ func å·²ç»è¢« debounced è¿‡ä¸€æ¬¡ä»¥åæ‰ä¼šåœ¨ trailing edge æ‰§è¡Œ</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>trailing <span class="token operator">&amp;&amp;</span> lastArgs<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token function">invokeFunc</span><span class="token punctuation">(</span>time<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// æ¯æ¬¡ trailingEdge éƒ½ä¼šæ¸…é™¤ lastArgs å’Œ lastThisï¼Œç›®çš„æ˜¯é¿å…æœ€åä¸€æ¬¡å‡½æ•°è¢«æ‰§è¡Œäº†ä¸¤æ¬¡</span>
        <span class="token comment">// ä¸¾ä¸ªä¾‹å­ï¼šæœ€åä¸€æ¬¡å‡½æ•°æ‰§è¡Œçš„æ—¶å€™ï¼Œå¯èƒ½æ°å·§æ˜¯å‰ä¸€æ¬¡çš„ trailing edgeï¼Œå‡½æ•°è¢«è°ƒç”¨ï¼Œè€Œè¿™ä¸ªå‡½æ•°åˆéœ€è¦åœ¨è‡ªå·±æ—¶å»¶çš„ trailing edge è§¦å‘ï¼Œå¯¼è‡´è§¦å‘å¤šæ¬¡</span>
        lastArgs <span class="token operator">=</span> lastThis <span class="token operator">=</span> <span class="token keyword">undefined</span>
        <span class="token keyword">return</span> result
    <span class="token punctuation">}</span>

    <span class="token comment">// åˆ é™¤å‡½æ•°ï¼Œåˆ é™¤æœªæ‰§è¡Œçš„å»¶è¿Ÿå‡½æ•°</span>
    <span class="token keyword">function</span> <span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>timerId <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">cancelTimer</span><span class="token punctuation">(</span>timerId<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        lastInvokeTime <span class="token operator">=</span> <span class="token number">0</span>
        lastArgs <span class="token operator">=</span> lastCallTime <span class="token operator">=</span> lastThis <span class="token operator">=</span> timerId <span class="token operator">=</span> <span class="token keyword">undefined</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// ç«‹å³æ‰§è¡Œæœªæ‰§è¡Œå‡½æ•°</span>
    <span class="token keyword">function</span> <span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> timerId <span class="token operator">===</span> <span class="token keyword">undefined</span> <span class="token operator">?</span> result <span class="token punctuation">:</span> <span class="token function">trailingEdge</span><span class="token punctuation">(</span>Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// åˆ¤æ–­æ˜¯å¦è¢«é˜»å¡</span>
    <span class="token keyword">function</span> <span class="token function">pending</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> timerId <span class="token operator">!==</span> <span class="token keyword">undefined</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// é˜²æŠ–ä¸»å‡½æ•°</span>
    <span class="token keyword">function</span> <span class="token function">debounced</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> time <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">const</span> isInvoking <span class="token operator">=</span> <span class="token function">shouldInvoke</span><span class="token punctuation">(</span>time<span class="token punctuation">)</span> <span class="token comment">//æ˜¯å¦æ»¡è¶³æ—¶é—´æ¡ä»¶</span>

        lastArgs <span class="token operator">=</span> args
        lastThis <span class="token operator">=</span> <span class="token keyword">this</span>
        lastCallTime <span class="token operator">=</span> time  <span class="token comment">//å‡½æ•°è¢«è°ƒç”¨çš„æ—¶é—´</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>isInvoking<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>timerId <span class="token operator">===</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// æ— timerIdçš„æƒ…å†µæœ‰ä¸¤ç§ï¼š1.é¦–æ¬¡è°ƒç”¨ 2.trailingEdgeæ‰§è¡Œè¿‡å‡½æ•°</span>
                <span class="token keyword">return</span> <span class="token function">leadingEdge</span><span class="token punctuation">(</span>lastCallTime<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>maxing<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// Handle invocations in a tight loop.</span>
                timerId <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>timerExpired<span class="token punctuation">,</span> wait<span class="token punctuation">)</span>
                <span class="token keyword">return</span> <span class="token function">invokeFunc</span><span class="token punctuation">(</span>lastCallTime<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// è´Ÿè´£ä¸€ç§caseï¼štrailing ä¸º true çš„æƒ…å†µä¸‹ï¼Œåœ¨å‰ä¸€ä¸ª wait çš„ trailingEdge å·²ç»æ‰§è¡Œäº†å‡½æ•°ï¼›</span>
        <span class="token comment">// è€Œè¿™æ¬¡å‡½æ•°è¢«è°ƒç”¨æ—¶ shouldInvoke ä¸æ»¡è¶³æ¡ä»¶ï¼Œå› æ­¤è¦è®¾ç½®å®šæ—¶å™¨ï¼Œåœ¨æœ¬æ¬¡çš„ trailingEdge ä¿è¯å‡½æ•°è¢«æ‰§è¡Œ</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>timerId <span class="token operator">===</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            timerId <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>timerExpired<span class="token punctuation">,</span> wait<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> result
    <span class="token punctuation">}</span>
    debounced<span class="token punctuation">.</span>cancel <span class="token operator">=</span> cancel
    debounced<span class="token punctuation">.</span>flush <span class="token operator">=</span> flush
    debounced<span class="token punctuation">.</span>pending <span class="token operator">=</span> pending
    <span class="token keyword">return</span> debounced
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br></div></div><p>æœ€åä¸ºå¤§å®¶æ¢³ç†ä¸€ä¸‹ <code>lodash</code> çš„å®ç°æ€è·¯ï¼š</p> <ul><li>â­ï¸ é¦–æ¬¡è¿›å…¥æ—¶ <code>lastCallTime === undefined</code> ä¸” <code>timerId === undefined</code> æ‰€ä»¥ä¼šè¿›å…¥ <code>leadingEdge</code>ï¼Œæ­¤æ—¶ <code>leading</code> ä¸º <code>true</code> æ—¶å°±ä¼šæ‰§è¡Œ <code>func</code> å¹¶è®¾ç½®å®šæ—¶å™¨ã€‚</li> <li>â­ï¸ ç­‰å¾… <code>wait</code> ç§’åä¼šæ‰§è¡Œ <code>timerExpired</code>ã€‚</li> <li>â­ï¸ 1ï¸âƒ£ è‹¥æœªåˆ° <code>wait</code> å°±å†æ¬¡è¢«è°ƒç”¨ä¼šæ›´æ–° <code>lastCallTime</code> ä¸” <code>isInvoking</code> æ¡ä»¶ä¸ç¬¦åˆæ‰€ä»¥ä¸ä¼šæ‰§è¡Œä»»ä½•æ“ä½œã€‚</li> <li>â­ï¸ 2ï¸âƒ£ è‹¥æ—¶é—´åˆ°è¾¾ <code>wait</code> å°±ä¼šæ‰§è¡Œä¸€å¼€å§‹è®¾å®šçš„ <code>timerExpired</code>ï¼Œä¸”æ­¤æ—¶ <code>time-lastCallTime &lt; wait</code>ï¼Œ æ‰€ä»¥ä¸ä¼šæ‰§è¡Œ <code>trailingEdge</code>ã€‚</li> <li>â­ï¸ æ­¤æ—¶åˆä¼šæ–°å¢ä¸€ä¸ªè®¡æ—¶å™¨ï¼Œä¸‹ä¸€æ¬¡æ‰§è¡Œçš„æ—¶é—´æ˜¯ <code>remainingWait</code> æ ¹æ®æ˜¯å¦æœ‰ <code>maxwait</code> æ¥åŒºåˆ†ã€‚</li> <li>â­ï¸ 1ï¸âƒ£ æ²¡æœ‰ <code>maxwait</code>ï¼Œåˆ™å®šæ—¶å™¨æ—¶é—´ä¸º <code>wait - timeSinceLastCall</code>ï¼Œä¿è¯ä¸‹ä¸€æ¬¡ <code>trailing</code> çš„æ‰§è¡Œã€‚</li> <li>â­ï¸ 2ï¸âƒ£ è‹¥æœ‰ <code>maxwait</code>ï¼Œä¸‹ä¸€æ¬¡å‡½æ•°è¦æ‰§è¡Œçš„æ—¶é—´ä¸ºä¸‹ä¸€æ¬¡ <code>maxing</code> å’Œä¸‹ä¸€æ¬¡ <code>trailing</code> çš„æœ€å°å€¼ã€‚</li> <li>â­ï¸ æœ€åè‹¥ä¸å†æœ‰è°ƒç”¨å°±åœ¨è®¡æ—¶å™¨ç»“æŸæ—¶è°ƒç”¨ <code>trailingEdge</code>ã€‚</li></ul> <p>è¿™é‡Œä¸å†ç»™å‡º <code>throttle</code> çš„å®ç°ä»£ç äº†ï¼Œå› ä¸ºå…¶æ˜¯ä»¥ <code>debounce</code> åŠ ä¸Š <code>maxwait</code> çš„æ–¹å¼å®ç°çš„ã€‚</p> <p>èªæ˜çš„ä½ ä¸€å®šçŸ¥é“åº”è¯¥æ€ä¹ˆå®ç°äº†ã€‚ ğŸ˜</p> <h3 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" aria-hidden="true" class="header-anchor">#</a> å‚è€ƒèµ„æ–™ ğŸ</h3> <ul><li>https://github.com/ZhangFe/Blog/issues/8</li> <li>https://github.com/lodash/lodash/blob/master/debounce.js</li> <li>https://www.lodashjs.com/docs/4.17.5.html#debounce</li> <li>https://css-tricks.com/debouncing-throttling-explained-examples/</li> <li>https://jinlong.github.io/2016/04/24/Debouncing-and-Throttling-Explained-Through-Examples/</li></ul> <h2 id="æé—®"><a href="#æé—®" aria-hidden="true" class="header-anchor">#</a> æé—®</h2> <p>è®²è§£å®Œäº†æ˜¨å¤©çš„é—®é¢˜ï¼Œåˆåˆ°äº†ä»Šå¤©çš„æé—®ç¯èŠ‚å•¦~</p> <h3 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" aria-hidden="true" class="header-anchor">#</a> èƒŒæ™¯ ğŸ</h3> <p><img src="https://blog-img-1252360401.cos.ap-guangzhou.myqcloud.com/2019-10-28-2.jpg" alt="å¤åˆ¶"></p> <p><code>å¥—å¨ƒ</code> æ˜¯æŒ‡åœ¨ä¸€å®šåŸºç¡€ä¸Šç¨ç¨æ”¹åŠ¨å°±å½¢æˆæ–°ä¸œè¥¿çš„ä¸€ç§æ“ä½œã€‚</p> <p>åœ¨æˆ‘ä»¬å†™ä»£ç çš„è¿‡ç¨‹ä¸­ä¸»è¦ä½“ç°ä¸ºå˜é‡çš„å¤åˆ¶ï¼Œåœ¨è¿™é‡Œå› ä¸ºåº•å±‚çš„ä¼˜åŒ–æœºåˆ¶åœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹å¤åˆ¶åªæ˜¯ <code>å…±ç”¨å†…å­˜æŒ‡é’ˆ</code> ã€‚</p> <p>è¿™å°±å¼•å‡ºäº†æˆ‘ä»¬çš„ <code>æ·±æ‹·è´</code> ä¸ <code>æµ…æ‹·è´</code> çš„é—®é¢˜ã€‚</p> <p>åŒæ—¶ <code>JavaScripté«˜çº§ç¨‹åºè®¾è®¡ï¼ˆçº¢å®ä¹¦ï¼‰</code> ä¸­æåˆ°çš„ <code>JSON.parse()</code> åŠ  <code>JSON.stringify()</code> çš„æ“ä½œå®é™…å­˜åœ¨æ€§èƒ½é—®é¢˜ã€‚</p> <h3 id="ä»Šæ—¥æé—®"><a href="#ä»Šæ—¥æé—®" aria-hidden="true" class="header-anchor">#</a> ä»Šæ—¥æé—® ğŸ</h3> <p><code>æ‹·è´</code> æ˜¯æˆ‘ä»¬ç»•ä¸è¿‡å»çš„åï¼Œé‚£å°±è®©æˆ‘ä»¬ä¸€èµ·å¤§æ­¥è¿ˆè¿‡å»å§ï¼</p> <p>ä»Šå¤©çš„é—®é¢˜æ˜¯ï¼š</p> <p>â­ï¸ <strong>è¯·ä½ å®ç°ä¸€ä¸ªå…¨ç±»å‹æ·±æ‹·è´å‡½æ•°åŠå¯¹å…¶è¿›è¡Œæ€§èƒ½ä¼˜åŒ–</strong></p></div> <!----> <footer class="page-edit"><!----></footer> <!----> </main></div> <div class="valine-wrapper" data-v-5d2e7f84><div id="valine" data-v-5d2e7f84></div></div></div></div></div></div></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.2e933218.js" defer></script><script src="/assets/js/3.b415292c.js" defer></script><script src="/assets/js/2.5bb3cc47.js" defer></script><script src="/assets/js/1.e6878f8a.js" defer></script><script src="/assets/js/15.0c829d9c.js" defer></script>
  </body>
</html>
