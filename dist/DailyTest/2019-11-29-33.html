<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>每日练题#33 | Clancy小屋</title>
    <meta name="description" content="慢慢来   比较快">
    <link rel="icon" href="icon.ico">
  <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    <meta property="article:published_time" content="2019-11-29T00:00:00.000Z"><meta property="article:modified_time" content="2019-11-29T03:50:37.000Z"><meta property="og:site_name" content="Clancy小屋"><meta property="og:title" content="每日练题#33"><meta property="og:type" content="website"><meta property="og:url" content="/DailyTest/2019-11-29-33.html"><meta name="twitter:title" content="每日练题#33"><meta name="twitter:url" content="/DailyTest/2019-11-29-33.html"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:label1" content="Written by"><meta name="twitter:label2" content="Filed under"><meta name="twitter:data2" content="DailyTest"><meta property="article:tag" content="DailyTest">
    <link rel="preload" href="/assets/css/0.styles.d73ca435.css" as="style"><link rel="preload" href="/assets/js/app.7c396a31.js" as="script"><link rel="preload" href="/assets/js/3.b5c6fc52.js" as="script"><link rel="preload" href="/assets/js/2.1a599976.js" as="script"><link rel="preload" href="/assets/js/1.35c567f8.js" as="script"><link rel="preload" href="/assets/js/36.38e5a6e4.js" as="script"><link rel="prefetch" href="/assets/js/10.4af595b9.js"><link rel="prefetch" href="/assets/js/11.91a89890.js"><link rel="prefetch" href="/assets/js/12.8af1d3d9.js"><link rel="prefetch" href="/assets/js/13.145f2b06.js"><link rel="prefetch" href="/assets/js/14.252a346d.js"><link rel="prefetch" href="/assets/js/15.fdbbb7ab.js"><link rel="prefetch" href="/assets/js/16.6d29a4a1.js"><link rel="prefetch" href="/assets/js/17.6d17c9a2.js"><link rel="prefetch" href="/assets/js/18.3713ae50.js"><link rel="prefetch" href="/assets/js/19.5b105b05.js"><link rel="prefetch" href="/assets/js/20.9b4f030e.js"><link rel="prefetch" href="/assets/js/21.7454c98e.js"><link rel="prefetch" href="/assets/js/22.450be24b.js"><link rel="prefetch" href="/assets/js/23.feb5a8ca.js"><link rel="prefetch" href="/assets/js/24.e5987bfa.js"><link rel="prefetch" href="/assets/js/25.626e861a.js"><link rel="prefetch" href="/assets/js/26.78e39c27.js"><link rel="prefetch" href="/assets/js/27.fcaa99e3.js"><link rel="prefetch" href="/assets/js/28.68027246.js"><link rel="prefetch" href="/assets/js/29.c51363f5.js"><link rel="prefetch" href="/assets/js/30.b198a56f.js"><link rel="prefetch" href="/assets/js/31.0fd00b1a.js"><link rel="prefetch" href="/assets/js/32.438e8cf5.js"><link rel="prefetch" href="/assets/js/33.47698b19.js"><link rel="prefetch" href="/assets/js/34.e50325a1.js"><link rel="prefetch" href="/assets/js/35.c41c90d4.js"><link rel="prefetch" href="/assets/js/37.25ed7571.js"><link rel="prefetch" href="/assets/js/38.2f6cff98.js"><link rel="prefetch" href="/assets/js/39.d4ad5033.js"><link rel="prefetch" href="/assets/js/40.f2d3901b.js"><link rel="prefetch" href="/assets/js/41.085cd5b7.js"><link rel="prefetch" href="/assets/js/42.78408395.js"><link rel="prefetch" href="/assets/js/43.04ef613a.js"><link rel="prefetch" href="/assets/js/44.b42a1531.js"><link rel="prefetch" href="/assets/js/45.de944501.js"><link rel="prefetch" href="/assets/js/46.1aa35fc7.js"><link rel="prefetch" href="/assets/js/47.205661d0.js"><link rel="prefetch" href="/assets/js/48.b38aacfc.js"><link rel="prefetch" href="/assets/js/49.5a24ad00.js"><link rel="prefetch" href="/assets/js/5.14c9112e.js"><link rel="prefetch" href="/assets/js/50.4b8b157d.js"><link rel="prefetch" href="/assets/js/51.89481733.js"><link rel="prefetch" href="/assets/js/52.347f804c.js"><link rel="prefetch" href="/assets/js/53.8fcd8efc.js"><link rel="prefetch" href="/assets/js/54.21373ce0.js"><link rel="prefetch" href="/assets/js/55.ed4d2756.js"><link rel="prefetch" href="/assets/js/56.7b046dfa.js"><link rel="prefetch" href="/assets/js/57.3f07e132.js"><link rel="prefetch" href="/assets/js/58.5c31f813.js"><link rel="prefetch" href="/assets/js/59.9decdebe.js"><link rel="prefetch" href="/assets/js/6.20eead11.js"><link rel="prefetch" href="/assets/js/60.cbaa772a.js"><link rel="prefetch" href="/assets/js/61.5582c4f0.js"><link rel="prefetch" href="/assets/js/62.c935f727.js"><link rel="prefetch" href="/assets/js/63.39c427df.js"><link rel="prefetch" href="/assets/js/64.69eb0cbe.js"><link rel="prefetch" href="/assets/js/7.7ce9ce30.js"><link rel="prefetch" href="/assets/js/8.4ce76333.js"><link rel="prefetch" href="/assets/js/9.f2a6eadd.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d73ca435.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div><div class="bg-container"><div id="particles-oli-wrapper" data-v-c339c0f6></div></div> <div class="main-container common"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="https://blog-img-1252360401.cos.ap-guangzhou.myqcloud.com/logo.jpg" alt="Clancy小屋" class="logo"> <span class="site-name">Clancy小屋</span></a> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-gitlab"></i>
  首页
</a></div><div class="nav-item"><a href="/category/IT/" class="nav-link"><i class="iconfont reco-eye"></i>
  教育技术
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-api"></i>
      前端
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/category/Front/" class="nav-link"><i class="iconfont undefined"></i>
  前端基础
</a></li><li class="dropdown-item"><!----> <a href="/category/TS/" class="nav-link"><i class="iconfont undefined"></i>
  TypeScript
</a></li><li class="dropdown-item"><!----> <a href="/category/Comment/" class="nav-link"><i class="iconfont undefined"></i>
  杂谈
</a></li></ul></div></div><div class="nav-item"><a href="/DailyTest/Navigator.html" class="nav-link"><i class="iconfont reco-three"></i>
  每日练题
</a></div><div class="nav-item"><a href="/timeLine.html" class="nav-link"><i class="iconfont reco-npm"></i>
  时光机
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-other"></i>
      关于
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/category/About/" class="nav-link"><i class="iconfont undefined"></i>
  关于我
</a></li></ul></div></div> <!----></nav> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div></div></header> <div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;background-color:rgba(231, 234, 241,.5);display:none;" data-v-6656a0de data-v-6656a0de><i class="iconfont reco-up" data-v-6656a0de></i></div> <div id="common" class="theme-container"><div class="common"><div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-gitlab"></i>
  首页
</a></div><div class="nav-item"><a href="/category/IT/" class="nav-link"><i class="iconfont reco-eye"></i>
  教育技术
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-api"></i>
      前端
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/category/Front/" class="nav-link"><i class="iconfont undefined"></i>
  前端基础
</a></li><li class="dropdown-item"><!----> <a href="/category/TS/" class="nav-link"><i class="iconfont undefined"></i>
  TypeScript
</a></li><li class="dropdown-item"><!----> <a href="/category/Comment/" class="nav-link"><i class="iconfont undefined"></i>
  杂谈
</a></li></ul></div></div><div class="nav-item"><a href="/DailyTest/Navigator.html" class="nav-link"><i class="iconfont reco-three"></i>
  每日练题
</a></div><div class="nav-item"><a href="/timeLine.html" class="nav-link"><i class="iconfont reco-npm"></i>
  时光机
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-other"></i>
      关于
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/category/About/" class="nav-link"><i class="iconfont undefined"></i>
  关于我
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>每日练题#33</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/DailyTest/2019-11-29-33.html#回顾上期" class="sidebar-link">回顾上期</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/DailyTest/2019-11-29-33.html#答案公布" class="sidebar-link">答案公布</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/DailyTest/2019-11-29-33.html#compiler-钩子" class="sidebar-link">compiler 钩子 🎏</a></li><li class="sidebar-sub-header"><a href="/DailyTest/2019-11-29-33.html#complation" class="sidebar-link">complation 🎏</a></li><li class="sidebar-sub-header"><a href="/DailyTest/2019-11-29-33.html#parse" class="sidebar-link">parse 🎏</a></li><li class="sidebar-sub-header"><a href="/DailyTest/2019-11-29-33.html#常用-loader-和-plugin" class="sidebar-link">常用 loader 和 plugin 🎏</a></li><li class="sidebar-sub-header"><a href="/DailyTest/2019-11-29-33.html#参考资料" class="sidebar-link">参考资料 🎏</a></li></ul></li><li><a href="/DailyTest/2019-11-29-33.html#提问" class="sidebar-link">提问</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/DailyTest/2019-11-29-33.html#背景" class="sidebar-link">背景 🎏</a></li><li class="sidebar-sub-header"><a href="/DailyTest/2019-11-29-33.html#今日提问" class="sidebar-link">今日提问 🎏</a></li></ul></li></ul></section></li></ul> </aside> <div><main class="page reco-hide"> <div class="page-title"><h1>每日练题#33</h1> <hr> <div style="position:relative;" data-v-6e6f5ac2><i class="iconfont reco-account" data-v-6e6f5ac2><span data-v-6e6f5ac2>Clancy Lin</span></i> <i class="iconfont reco-date" data-v-6e6f5ac2><span data-v-6e6f5ac2>2019-11-29</span></i> <!----> <i class="iconfont reco-tag tags" data-v-6e6f5ac2><span class="tag-item" data-v-6e6f5ac2>DailyTest</span></i> <span class="pageFull" data-v-6e6f5ac2>全屏</span></div></div> <div class="content__default"><p>欢迎回来！ 😄</p> <p>这里是每日练题系列。</p> <p>这个系列会先分享昨天问题的答案并提出新的问题。</p> <h2 id="回顾上期"><a href="#回顾上期" aria-hidden="true" class="header-anchor">#</a> 回顾上期</h2> <p>上期我们提出的问题是：</p> <p>⭐️ <strong>请你谈谈 <code>Webpack</code> 的生命周期以及常用的 <code>loader</code> 和 <code>plugin</code></strong></p> <h2 id="答案公布"><a href="#答案公布" aria-hidden="true" class="header-anchor">#</a> 答案公布</h2> <p><img src="https://blog-img-1252360401.cos.ap-guangzhou.myqcloud.com/20191129-1.jpg" alt="Webpack"></p> <p>所谓的 <code>Webpack 生命周期</code>，其实是在运行过程中为我们提供的一系列的钩子。</p> <p>关于生命周期，</p> <p>其主要分为三大类：<code>compiler钩子</code> 、 <code>compilation钩子</code> 和 <code>parser钩子</code></p> <div class="tip custom-block"><p>当前 webpack 版本为 <code>v4.41.2</code></p></div> <h3 id="compiler-钩子"><a href="#compiler-钩子" aria-hidden="true" class="header-anchor">#</a> compiler 钩子 🎏</h3> <p><code>Compiler</code> 模块是 <code>webpack</code> 工作的主要引擎，</p> <p>通过传递的选项，创建出一个 <code>compilation</code> 实例。</p> <p>同时它还支持可以监控文件系统的 <code>watching</code> 机制，</p> <p>这也是开发服务器 <code>webpack-dev-server</code> 的基石。</p> <p>下面我们通过一个表格来看看提供给我们的钩子都有哪些：</p> <table><thead><tr><th>⭐️ 生命周期名称</th> <th>⭐️ 类型</th> <th>⭐️ 参数</th> <th>⭐️ 说明</th></tr></thead> <tbody><tr><td>entryOption</td> <td>SyncBailHook</td> <td>context, entry</td> <td>entry 配置项处理后</td></tr> <tr><td>afterPlugins</td> <td>SyncHook</td> <td>compiler</td> <td>初始化后</td></tr> <tr><td>afterResolvers</td> <td>SyncHook</td> <td>compiler</td> <td>resolver 安装完成后</td></tr> <tr><td>environment</td> <td>SyncHook</td> <td>--</td> <td>environment 准备好后</td></tr> <tr><td>afterEnvironment</td> <td>SyncHook</td> <td>--</td> <td>environment 安装完成后</td></tr> <tr><td>beforeRun</td> <td>AsyncSeriesHook</td> <td>compiler</td> <td>compiler.run() 执行前</td></tr> <tr><td>run</td> <td>AsyncSeriesHook</td> <td>compiler</td> <td>开始读取 records 前，钩入 compiler</td></tr> <tr><td>watchRun</td> <td>AsyncSeriesHook</td> <td>compiler</td> <td>监听模式下新编译触发后，但是在实际编译开始前</td></tr> <tr><td>normalModuleFactory</td> <td>SyncHook</td> <td>normalModuleFactory</td> <td>NormalModuleFactory 创建之后</td></tr> <tr><td>contextModuleFactory</td> <td>-</td> <td>contextModuleFactory</td> <td>contextModuleFactory 创建之后</td></tr> <tr><td>beforeCompile</td> <td>AsyncSeriesHook</td> <td>compilationParams</td> <td>编译参数创建之后，还没开始编译</td></tr> <tr><td>compile</td> <td>SyncHook</td> <td>compilationParams</td> <td>新编译创建之后</td></tr> <tr><td>thisCompilation</td> <td>SyncHook</td> <td>compilation</td> <td>触发编译事件之前执行</td></tr> <tr><td>compilation</td> <td>SyncHook</td> <td>compilation</td> <td>编译创建之后</td></tr> <tr><td>make</td> <td>AsyncParallelHook</td> <td>compilation</td> <td>结束编译之前执行</td></tr> <tr><td>afterCompile</td> <td>AsyncSeriesHook</td> <td>compilation</td> <td>结束编译之后执行</td></tr> <tr><td>shouldEmit</td> <td>SyncBailHook</td> <td>compilation</td> <td>调用静态资源前（需要返回 boolean）</td></tr> <tr><td>emit</td> <td>AsyncSeriesHook</td> <td>compilation</td> <td>生成资源到 output 目录前</td></tr> <tr><td>afterEmit</td> <td>AsyncSeriesHook</td> <td>compilation</td> <td>生成资源到 output 目录后</td></tr> <tr><td>assetEmitted</td> <td>AsyncSeriesHook</td> <td>file, content</td> <td>获得正在生成资源的钩子</td></tr> <tr><td>done</td> <td>SyncHook</td> <td>stats</td> <td>编译完成</td></tr> <tr><td>failed</td> <td>SyncHook</td> <td>error</td> <td>编译失败</td></tr> <tr><td>invalid</td> <td>SyncHook</td> <td>fileName, changeTime</td> <td>监听模式下编译无效时</td></tr> <tr><td>watchClose</td> <td>SyncHook</td> <td>--</td> <td>监听模式停止</td></tr> <tr><td>infrastructureLog</td> <td>SyncBailHook</td> <td>name, type, args</td> <td>可以进行基础日志记录时</td></tr> <tr><td>log</td> <td>SyncBailHook</td> <td>origin, logEntry</td> <td>进行日志记录时</td></tr></tbody></table> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 示例代码</span>
<span class="token comment">// 同步时使用 .tap , 异步时使用 .tapAsync 或 .tapPromise</span>
compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>钩子名<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">'插件名'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">参数</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="complation"><a href="#complation" aria-hidden="true" class="header-anchor">#</a> complation 🎏</h3> <p><code>Compilation</code> 模块被 <code>Compiler</code> 使用来创建一个新的编译实例。</p> <p><code>complation</code> 实例能够访问所有的模块及其依赖，</p> <p>会对依赖图中的所有模块进行字面上的编译（literal compilation）。</p> <p>其编译过程主要有下面几个：</p> <ul><li>1️⃣ 加载（loaded）</li> <li>2️⃣ 封存（sealed）</li> <li>3️⃣ 优化（optimized）</li> <li>4️⃣ 分块（chunked）</li> <li>5️⃣ 哈希（hashed）</li> <li>6️⃣ 重新创建（restored）</li></ul> <p>其钩子使用方式同 <code>Compiler</code> 模块。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>compilation<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>钩子<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><table><thead><tr><th>⭐️ 生命周期名称</th> <th>⭐️ 类型</th> <th>⭐️ 参数</th> <th>⭐️ 说明</th></tr></thead> <tbody><tr><td>buildModule</td> <td>SyncHook</td> <td>module</td> <td>模块构建开始前</td></tr> <tr><td>rebuildModule</td> <td>SyncHook</td> <td>module</td> <td>重新构建一个模块开始前</td></tr> <tr><td>failedModule</td> <td>SyncHook</td> <td>module, error</td> <td>模块构建失败时</td></tr> <tr><td>succeedModule</td> <td>SyncHook</td> <td>module</td> <td>模块构建成功时</td></tr> <tr><td>finishRebuildingModule</td> <td>SyncHook</td> <td>module</td> <td>一个模块完成构建</td></tr> <tr><td>finishModules</td> <td>SyncHook</td> <td>modules</td> <td>所有模块完成构建</td></tr> <tr><td>seal</td> <td>SyncHook</td> <td>--</td> <td>编译停止接收新模块</td></tr> <tr><td>unseal</td> <td>SyncHook</td> <td>--</td> <td>编译开始接收新模块</td></tr> <tr><td>optimizeDependenciesBasic</td> <td>SyncBailHook</td> <td>modules</td> <td>在v5版本废弃</td></tr> <tr><td>optimizeDependencies</td> <td>SyncBailHook</td> <td>modules</td> <td>依赖优化开始时</td></tr> <tr><td>optimizeDependenciesAdvanced</td> <td>SyncBailHook</td> <td>modules</td> <td>在v5版本废弃</td></tr> <tr><td>optimize</td> <td>SyncHook</td> <td>--</td> <td>优化阶段开始时</td></tr> <tr><td>afterOptimizeDependencies</td> <td>SyncHook</td> <td>modules</td> <td>依赖优化结束后</td></tr> <tr><td>optimizeModulesBasic</td> <td>SyncBailHook</td> <td>modules</td> <td>在v5版本废弃</td></tr> <tr><td>optimizeModules</td> <td>SyncBailHook</td> <td>modules</td> <td>依赖优化阶段模块开始解析时</td></tr> <tr><td>optimizeModulesAdvanced</td> <td>SyncBailHook</td> <td>modules</td> <td>在v5版本废弃</td></tr> <tr><td>afterOptimizeModules</td> <td>SyncHook</td> <td>modules</td> <td>模块优化完成</td></tr> <tr><td>optimizeChunksBasic</td> <td>SyncBailHook</td> <td>chunks</td> <td>在v5版本废弃</td></tr> <tr><td>optimizeChunks</td> <td>SyncBailHook</td> <td>chunks</td> <td>优化 chunks</td></tr> <tr><td>optimizeChunksAdvanced</td> <td>SyncBailHook</td> <td>chunks</td> <td>在v5版本废弃</td></tr> <tr><td>afterOptimizeChunks</td> <td>SyncBailHook</td> <td>chunks</td> <td>chunks 优化完成后</td></tr> <tr><td>optimizeTree</td> <td>AsyncSeriesHook</td> <td>chunks, modules</td> <td>异步优化依赖树</td></tr> <tr><td>afterOptimizeTree</td> <td>SyncHook</td> <td>chunks, modules</td> <td>依赖树优化完成</td></tr> <tr><td>optimizeChunkModulesBasic</td> <td>SyncBailHook</td> <td>chunks, modules</td> <td>在v5版本废弃</td></tr> <tr><td>optimizeChunkModules</td> <td>SyncBailHook</td> <td>chunks, modules</td> <td>依赖树优化完成后，模块优化开始前</td></tr> <tr><td>optimizeChunkModulesAdvanced</td> <td>SyncBailHook</td> <td>chunks, modules</td> <td>在v5版本废弃</td></tr> <tr><td>afterOptimizeChunkModules</td> <td>SyncHook</td> <td>chunks, modules</td> <td>模块优化成功完成</td></tr> <tr><td>shouldRecord</td> <td>SyncBailHook</td> <td>--</td> <td>配置是否可记录，若返回 <code>false</code> 的结果那么其他 <code>record</code> 钩子将会失效</td></tr> <tr><td>reviveModules</td> <td>SyncHook</td> <td>modules, records</td> <td>从 records 中恢复模块信息</td></tr> <tr><td>reviveChunks</td> <td>SyncHook</td> <td>modules, records</td> <td>从 records 中恢复 chunk 信息</td></tr> <tr><td>optimizeModuleOrder</td> <td>SyncHook</td> <td>modules</td> <td>模块从重要到不重要排序（在v5版本废弃）</td></tr> <tr><td>advancedOptimizeModuleOrder</td> <td>SyncHook</td> <td>modules</td> <td>在v5版本废弃</td></tr> <tr><td>beforeModuleIds</td> <td>SyncHook</td> <td>modules</td> <td>在给模块添加 <code>id</code> 前</td></tr> <tr><td>moduleIds</td> <td>SyncHook</td> <td>modules</td> <td>在给模块添加 <code>id</code></td></tr> <tr><td>optimizeModuleIds</td> <td>SyncHook</td> <td>modules</td> <td>优化某模块 id</td></tr> <tr><td>afterOptimizeModuleIds</td> <td>SyncHook</td> <td>modules</td> <td>某 id 模块优化结束</td></tr> <tr><td>optimizeChunkOrder</td> <td>SyncHook</td> <td>chunks</td> <td>将 chunk 从最重要的到最不重要的进行排序（在v5版本废弃）</td></tr> <tr><td>beforeOptimizeChunkIds</td> <td>SyncHook</td> <td>chunks</td> <td>chunk id 优化之前触发</td></tr> <tr><td>optimizeChunkIds</td> <td>SyncHook</td> <td>chunks</td> <td>优化每个 chunk 的 id</td></tr> <tr><td>afterOptimizeChunkIds</td> <td>SyncHook</td> <td>chunks</td> <td>chunk id 优化完成</td></tr> <tr><td>recordModules</td> <td>SyncHook</td> <td>modules, chunks</td> <td>将模块信息存储到 records</td></tr> <tr><td>recordChunks</td> <td>SyncHook</td> <td>chunks, chunks</td> <td>将 chunk 信息存储到 records</td></tr> <tr><td>beforeHash</td> <td>SyncHook</td> <td>--</td> <td>编译哈希之前</td></tr> <tr><td>afterHash</td> <td>SyncHook</td> <td>--</td> <td>编译哈希之后</td></tr> <tr><td>recordHash</td> <td>SyncHook</td> <td>records</td> <td>存储哈希信息，需要 shouldRecord 不返回 false</td></tr> <tr><td>record</td> <td>SyncHook</td> <td>compilation, records</td> <td>将 compilation 相关信息存储到 records 中</td></tr> <tr><td>beforeModuleAssets</td> <td>SyncHook</td> <td>--</td> <td>模块资源加载前</td></tr> <tr><td>additionalChunkAssets</td> <td>SyncHook</td> <td>chunks</td> <td>为 chunk 增加额外资源</td></tr> <tr><td>shouldGenerateChunkAssets</td> <td>SyncBailHook</td> <td>--</td> <td>是否可以创建 chunk 资源，返回 boolean</td></tr> <tr><td>beforeChunkAssets</td> <td>SyncHook</td> <td>--</td> <td>创建 chunk 资源前</td></tr> <tr><td>additionalChunkAssets</td> <td>SyncHook</td> <td>chunks</td> <td>为 chunk 增加额外资源</td></tr> <tr><td>additionalAssets</td> <td>AsyncSeriesHook</td> <td>--</td> <td>为编译创建额外资源</td></tr> <tr><td>optimizeChunkAssets</td> <td>AsyncSeriesHook</td> <td>chunks</td> <td>优化所有 chunk 资源</td></tr> <tr><td>afterOptimizeChunkAssets</td> <td>SyncHook</td> <td>chunks</td> <td>chunk 资源已经被优化</td></tr> <tr><td>optimizeAssets</td> <td>AsyncSeriesHook</td> <td>assets</td> <td>优化存储在 compilation.assets 中的所有资源</td></tr> <tr><td>afterOptimizeAssets</td> <td>SyncHook</td> <td>assets</td> <td>资源优化结束</td></tr> <tr><td>needAdditionalSeal</td> <td>SyncBailHook</td> <td>--</td> <td>确定是否需要开启编译包含其他文件</td></tr> <tr><td>afterSeal</td> <td>AsyncSeriesHook</td> <td>--</td> <td>after needAdditionalSeal</td></tr> <tr><td>chunkHash</td> <td>SyncHook</td> <td>chunk, chunkHash</td> <td>上报每个 chunk 的哈希值</td></tr> <tr><td>moduleAsset</td> <td>SyncHook</td> <td>module, filename</td> <td>一个模块中的一个资源被添加到编译中</td></tr> <tr><td>chunkAsset</td> <td>SyncHook</td> <td>chunk, filename</td> <td>一个 chunk 中的一个资源被添加到编译中</td></tr> <tr><td>assetPath</td> <td>SyncWaterfallHook</td> <td>filename, data</td> <td>资源路径</td></tr> <tr><td>needAdditionalPass</td> <td>SyncBailHook</td> <td>--</td> <td>调用确定是否需要进一步的处理</td></tr> <tr><td>childCompiler</td> <td>SyncHook</td> <td>childCompiler, compilerName, compilerIndex</td> <td>调用一个子编译实例后</td></tr> <tr><td>normalModuleLoader</td> <td>SyncHook</td> <td>loaderContext, module</td> <td>普通模块 loader，真正（一个接一个地）加载模块图(graph)中所有模块的函数</td></tr> <tr><td>dependencyReference</td> <td>SyncWaterfallHook</td> <td>depRef,dependency, module</td> <td>允许更改依赖项报告</td></tr></tbody></table> <div class="tip custom-block"><p><strong>optimizeChunkAssets</strong>
优化所有 chunk 资源(asset)。资源(asset)会被存储在 compilation.assets。每个 Chunk 都有一个 files 属性，指向这个 chunk 创建的所有文件。附加资源(asset)被存储在 compilation.additionalChunkAssets 中。</p></div> <h3 id="parse"><a href="#parse" aria-hidden="true" class="header-anchor">#</a> parse 🎏</h3> <p><code>parse</code> 实例是用于解析 <code>webpack</code> 处理过的每个模块，</p> <p>我们来看一下官方文档中的案例：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 处于 normalModuleFactory 中</span>
<span class="token comment">// 需要额外钩子获取</span>
compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>normalModuleFactory<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token parameter">factory</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  factory<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>parser<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">parser<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    parser<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>钩子<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>其相关钩子如下:</p> <table><thead><tr><th>⭐️ 生命周期名称</th> <th>⭐️ 类型</th> <th>⭐️ 参数</th> <th>⭐️ 说明</th></tr></thead> <tbody><tr><td>evaluateTypeof</td> <td>SyncBailHook</td> <td>expression</td> <td>取标识符类型</td></tr> <tr><td>evaluate</td> <td>SyncBailHook</td> <td>expression</td> <td>表达式取值</td></tr> <tr><td>evaluateIdentifier</td> <td>SyncBailHook</td> <td>expression</td> <td>取一个自由变量标识符</td></tr> <tr><td>evaluateDefinedIdentifier</td> <td>SyncBailHook</td> <td>expression</td> <td>取一个定义变量标识符</td></tr> <tr><td>evaluateCallExpressionMember</td> <td>SyncBailHook</td> <td>expression, param</td> <td>进行一次「成功取值表达式的成员函数」调用取值</td></tr> <tr><td>statement</td> <td>SyncBailHook</td> <td>statement</td> <td>从代码片段中解析语句时</td></tr> <tr><td>statementIf</td> <td>SyncBailHook</td> <td>statement</td> <td>同 statement， 但只在 statement.type == 'IfStatement' 时触发</td></tr> <tr><td>label</td> <td>SyncBailHook</td> <td>statement</td> <td>在 statement.type == 'LabeledStatement' 时触发（需传入 labelName）</td></tr> <tr><td>import</td> <td>SyncBailHook</td> <td>statement, source</td> <td>代码片段有 import 解析触发</td></tr> <tr><td>importSpecifier</td> <td>SyncBailHook</td> <td>statement, source, exportName, identifierName</td> <td>代码片段有 import 声明符解析触发</td></tr> <tr><td>export</td> <td>SyncBailHook</td> <td>statement</td> <td>代码片段有 export 触发</td></tr> <tr><td>exportImport</td> <td>SyncBailHook</td> <td>statement, source</td> <td>代码片段有 export * from 'otherModule' 时触发</td></tr> <tr><td>exportDeclaration</td> <td>SyncBailHook</td> <td>statement, declaration</td> <td>代码片段有 export 声明时触发</td></tr> <tr><td>exportExpression</td> <td>SyncBailHook</td> <td>statement, declaration</td> <td>代码片段有 export default expression 时触发</td></tr> <tr><td>exportSpecifier</td> <td>SyncBailHook</td> <td>statement, identifierName, exportName, index</td> <td>代码片段有 export 声明符解析触发</td></tr> <tr><td>exportImportSpecifier</td> <td>SyncBailHook</td> <td>statement, source, identifierName, exportName, index</td> <td>代码片段有 export 解析触发</td></tr> <tr><td>varDeclaration</td> <td>SyncBailHook</td> <td>declaration</td> <td>代码片段有变量声明触发</td></tr> <tr><td>varDeclarationConst</td> <td>SyncBailHook</td> <td>declaration</td> <td>代码片段有使用 const 声明变量触发</td></tr> <tr><td>varDeclarationLet</td> <td>SyncBailHook</td> <td>declaration</td> <td>代码片段有使用 let 声明变量触发</td></tr> <tr><td>varDeclarationVar</td> <td>SyncBailHook</td> <td>declaration</td> <td>代码片段有使用 var 声明变量触发</td></tr> <tr><td>canRename</td> <td>SyncBailHook</td> <td>expression</td> <td>是否允许重命名（传入 identifier）</td></tr> <tr><td>rename</td> <td>SyncBailHook</td> <td>expression</td> <td>重命名（传入 identifier）</td></tr> <tr><td>assigned</td> <td>SyncBailHook</td> <td>expression</td> <td>解析 AssignmentExpression 之前（传入 identifier）</td></tr> <tr><td>assign</td> <td>SyncBailHook</td> <td>expression</td> <td>解析 AssignmentExpression 之前（传入 identifier）</td></tr> <tr><td>typeof</td> <td>SyncBailHook</td> <td>expression</td> <td>解析 typeof 时（传入 identifier）</td></tr> <tr><td>call</td> <td>SyncBailHook</td> <td>expression</td> <td>解析 call 时（传入 identifier）</td></tr> <tr><td>callAnyMember</td> <td>SyncBailHook</td> <td>expression</td> <td>解析对象里的函数 call 调用（传入 objectIdentifier）</td></tr> <tr><td>new</td> <td>SyncBailHook</td> <td>expression</td> <td>解析 new 时（传入 identifier）</td></tr> <tr><td>expression</td> <td>SyncBailHook</td> <td>expression</td> <td>解析表达式时（传入 identifier）</td></tr> <tr><td>expressionAnyMember</td> <td>SyncBailHook</td> <td>expression</td> <td>解析 expressionAnyMember 时（传入 identifier）</td></tr> <tr><td>expressionConditionalOperator</td> <td>SyncBailHook</td> <td>expression</td> <td>解析 ConditionalExpression (三元表达式)时（传入 identifier）</td></tr> <tr><td>program</td> <td>SyncBailHook</td> <td>ast, comments</td> <td>访问代码片段的抽象语法树</td></tr></tbody></table> <div class="tip custom-block"><p>evaluate 取值
<img src="https://blog-img-1252360401.cos.ap-guangzhou.myqcloud.com/20191129-2.png" alt=""></p></div> <h3 id="常用-loader-和-plugin"><a href="#常用-loader-和-plugin" aria-hidden="true" class="header-anchor">#</a> 常用 loader 和 plugin 🎏</h3> <p>常用的有这么一些：</p> <table><thead><tr><th>⭐️ 名称</th> <th>⭐️ 类型</th> <th>⭐️ 功能</th></tr></thead> <tbody><tr><td>less-loader</td> <td>loader</td> <td>处理 less</td></tr> <tr><td>sass-loader</td> <td>loader</td> <td>处理 sass、scss</td></tr> <tr><td>stylus-loader</td> <td>loader</td> <td>处理 stylus</td></tr> <tr><td>url-loader</td> <td>loader</td> <td>处理 url</td></tr> <tr><td>file-loader</td> <td>loader</td> <td>处理文件</td></tr> <tr><td>file-loader</td> <td>loader</td> <td>处理文件</td></tr> <tr><td>babel 全家桶</td> <td>loader</td> <td>语法转换</td></tr> <tr><td>expose-loader</td> <td>loader</td> <td>模块暴露到全局</td></tr> <tr><td>NormalModuleReplacementPlugin</td> <td>plugin</td> <td>匹配resourceRegExp，替换为newResource</td></tr> <tr><td>ContextReplacementPlugin</td> <td>plugin</td> <td>替换上下文</td></tr> <tr><td>IgnorePlugin</td> <td>plugin</td> <td>不打包匹配文件</td></tr> <tr><td>PrefetchPlugin</td> <td>plugin</td> <td>预加载</td></tr> <tr><td>ResolverPlugin</td> <td>plugin</td> <td>替换上下文</td></tr> <tr><td>ContextReplacementPlugin</td> <td>plugin</td> <td>替换上下文</td></tr> <tr><td>DedupePlugin</td> <td>plugin</td> <td>删除重复文件</td></tr> <tr><td>MinChunkSizePlugin</td> <td>plugin</td> <td>合并小模块</td></tr> <tr><td>LimitChunkCountPlugin</td> <td>plugin</td> <td>限制打包文件个数</td></tr> <tr><td>MinChunkSizePlugin</td> <td>plugin</td> <td>合并小模块</td></tr> <tr><td>OccurrenceOrderPlugin</td> <td>plugin</td> <td>根据调用次数分配id</td></tr> <tr><td>UglifyJsPlugin</td> <td>plugin</td> <td>压缩js</td></tr> <tr><td>CommonsChunkPlugin</td> <td>plugin</td> <td>公用依赖</td></tr> <tr><td>ProvidePlugin</td> <td>plugin</td> <td>自动加载模块</td></tr> <tr><td>HotModuleReplacementPlugin</td> <td>plugin</td> <td>模块热替换</td></tr> <tr><td>ProgressPlugin</td> <td>plugin</td> <td>编译进度</td></tr> <tr><td>HtmlWebpackPlugin</td> <td>plugin</td> <td>生成 html</td></tr> <tr><td>NoErrorsPlugin</td> <td>plugin</td> <td>报错但不退出webpack进程</td></tr></tbody></table> <div class="tip custom-block"><p>这里只是列出一些比较常用的~ loader 和 plugin 有千千万万种。 😏</p></div> <h3 id="参考资料"><a href="#参考资料" aria-hidden="true" class="header-anchor">#</a> 参考资料 🎏</h3> <ul><li>https://webpack.js.org/api/</li> <li>https://segmentfault.com/a/1190000005106383</li></ul> <h2 id="提问"><a href="#提问" aria-hidden="true" class="header-anchor">#</a> 提问</h2> <p>讲解完了昨天的问题，又到了今天的提问环节啦~</p> <h3 id="背景"><a href="#背景" aria-hidden="true" class="header-anchor">#</a> 背景 🎏</h3> <p>前面两天我们已经对 <code>webpack</code> 中的基础概念有了比较深入的了解了，</p> <p>那么在使用过之后，</p> <p>不同的人使用 <code>webpack</code> 的效率是完全不同的，</p> <p>这是为什么呢？</p> <h3 id="今日提问"><a href="#今日提问" aria-hidden="true" class="header-anchor">#</a> 今日提问 🎏</h3> <p>“古调虽自爱，今人多不弹。”</p> <hr> <p><strong>今天的问题是：</strong></p> <p>⭐️ <strong>请你谈谈 <code>Webpack</code> 的优化策略</strong></p></div> <!----> <footer class="page-edit"><!----></footer> <!----> </main> <div class="valine-wrapper" data-v-154aa140><div id="valine" data-v-154aa140></div></div></div></div></div></div></div><div class="global-ui"><div class="reading-progress top" data-v-7681808f><div class="progress" data-v-7681808f></div></div></div></div>
    <script src="/assets/js/app.7c396a31.js" defer></script><script src="/assets/js/3.b5c6fc52.js" defer></script><script src="/assets/js/2.1a599976.js" defer></script><script src="/assets/js/1.35c567f8.js" defer></script><script src="/assets/js/36.38e5a6e4.js" defer></script>
  </body>
</html>
